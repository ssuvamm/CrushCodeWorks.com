---
import BaseLayout from '@/layouts/BaseLayout.astro';
import { getCollection, getEntry } from 'astro:content';

export async function getStaticPaths() {
  const entries = await getCollection('blog');
  return entries.map((entry) => ({ params: { slug: entry.slug } }));
}

const { slug } = Astro.params;
const entry = slug ? await getEntry('blog', slug) : undefined;
if (!entry) return Astro.redirect('/blog');
const { Content } = await entry.render();
---
<BaseLayout title={`${entry.data.title} | CrushCodeWorks`}>
  <article class="container py-20">
    <h1 class="font-heading text-5xl">{entry.data.title}</h1>
    <p class="mt-3 text-muted-foreground">{entry.data.excerpt}</p>
    <div class="mt-10 space-y-4 text-muted-foreground"><Content /></div>
  </article>
</BaseLayout>
